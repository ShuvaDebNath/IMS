<div class="container shadow-sm p-3 mb-5 bg-white rounded">
  <h1 class="theme-text">Generate Monthly Report Form</h1>

  <br />
  <form [formGroup]="taskForm" style="overflow: scroll;">
    <!-- Header fields -->
    <div class="row mb-3">
      <div class="col-md-6">
        <label class="form-label">Task No</label>
        <input
          autocomplete="off"
          type="text"
          formControlName="TaskNo"
          class="form-control"
          placeholder="Task No"
          id="taskNo"
          name="taskNo"
          value=""
          readonly
        />
      </div>
      <div class="col-md-6">
        <label class="control-label">Date</label>

        <input
              type="date"
              formControlName="Date"
              class="form-control"
            />
      </div>
    </div>

    <!-- Items table (Monthly Report fields) -->
    <table class="table table-bordered" style="width:160% !important;">
      <thead>
        <tr>
          <th style="text-align: center">Customer Name</th>
          <th style="text-align: center">How many team you work</th>
          <th style="text-align: center">Order Season</th>
          <th style="text-align: center">Description</th>
          <th style="text-align: center">Time and purpose of first visit this month</th>
          <th style="text-align: center">Time and purpose of second visit this month</th>
          <th style="text-align: center">Time and purpose of third visit this month</th>
          <th style="text-align: center">Order Summary</th>
          <th style="text-align: center">Summary of Submitted Sample</th>
          <th style="text-align: center">Summary of New Article Developed</th>
          <th style="width: 60px"></th>
        </tr>
      </thead>

      <tbody formArrayName="items" style="width: 160% !important;">
        <tr *ngFor="let item of items.controls; let i = index" [formGroupName]="i">
          <td>
            <p-dropdown appendTo="body"
              class="p-0 rm-dd"
              [panelStyle]="{ width: '300px' }"
              [options]="CustomerList"
              optionLabel="CustomerName"
              optionValue="Customer_ID"
              [filter]="true"
              [virtualScroll]="true"
              [itemSize]="30"
              filterBy="CustomerName"
              [showClear]="true"
              placeholder="Select Customer"
              formControlName="CustomerName"
            ></p-dropdown>
          </td>

          <td>
            <p-dropdown appendTo="body" [options]="teamOptions" optionLabel="label" optionValue="value" placeholder="Team" formControlName="TeamSize"></p-dropdown>
          </td>

          <td>
            <p-dropdown appendTo="body" [options]="orderSeasons" optionLabel="label" optionValue="value" placeholder="Order Season" formControlName="OrderSeason"></p-dropdown>
          </td>

          <td>
            <input class="form-control form-control-sm" formControlName="Description" />
          </td>

          <td>
            <input class="form-control form-control-sm" formControlName="Visit1" />
          </td>

          <td>
            <input class="form-control form-control-sm" formControlName="Visit2" />
          </td>

          <td>
            <input class="form-control form-control-sm" formControlName="Visit3" />
          </td>

          <td>
            <textarea class="form-control form-control-sm" formControlName="OrderSummary"></textarea>
          </td>

          <td>
            <textarea class="form-control form-control-sm" formControlName="SampleSummary"></textarea>
          </td>

          <td>
            <textarea class="form-control form-control-sm" formControlName="NewArticleSummary"></textarea>
          </td>

          <td>
            <button type="button" class="btn btn-sm btn-danger" (click)="removeItem(i)">Ã—</button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="d-flex justify-content-end gap-2 mt-3">
      <button type="button" class="btn btn-outline-success" (click)="addItem()">
        <i class="bi bi-plus-circle me-1"></i> Add Row
      </button>

      <button
        type="submit"
        (click)="saveData()"
        [ngClass]="{
          'theme-btn-disable': taskForm.invalid
        }"
        class="btn theme-btn btn-rounded"
        [disabled]="taskForm.invalid"
        *ngIf="!isEdit"
      >
        <i class="bi bi-save me-1"></i> Save
      </button>
      <button
        type="submit"
        (click)="UpdateData()"
        [ngClass]="{
          'theme-btn-disable': taskForm.invalid
        }"
        class="btn theme-btn btn-rounded"
        [disabled]="taskForm.invalid"
        *ngIf="isEdit"
      >
        <i class="bi bi-save me-1"></i> Save
      </button>
    </div>
  </form>
</div>
