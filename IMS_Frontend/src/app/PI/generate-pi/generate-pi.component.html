<div class="p-3 m-2 shadow-sm">
  <form name="PIForm" [formGroup]="Formgroup" role="form">
    <div class="card p-3">
      <div
        class="sticky-header d-flex align-items-center justify-content-between pt-4"
      >
        <h1 class="fw-normal">Proforma Invoice</h1>
        <div class="float-right">
          <button
            class="btn btn-sm btn-pi-save mr-2"
            (click)="Save()"
            [disabled]="!Formgroup.valid"
            style="width: 130px; height: 38px"
          >
            <i class="fas fa-save"></i>&nbsp;Save
          </button>
          <button
            class="btn btn-sm btn-pi-refresh"
            (click)="RefrashDDL()"
            style="width: 130px; height: 38px"
          >
            <i class="fas fa-sync"></i>&nbsp;Refresh
          </button>
        </div>
      </div>
      <hr />
      <div class="card-body">
  
        <!-- Consignee Initial -->
        <div class="row mb-1">
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <!-- g-1 diye gutter khub kom -->
              <div class="col-3">
                <label class="mb-0"
                  >Consignee <br />
                  Initial</label
                >
              </div>
              <div class="col-7">
                <input
                  type="text"
                  class="form-control form-control-sm"
                  formControlName="Consignee_Initial"
                  [style]="{
                    width: '70%',
                    borderRadius: '5px',
                    height: '38px',
                    padding: '5px 10px',
                  }"
                />
                <div
                  *ngIf="
                    Formgroup.get('Consignee_Initial')?.touched &&
                    Formgroup.get('Consignee_Initial')?.invalid
                  "
                  class="text-danger"
                  style="font-size: 0.8rem; margin-top: 2px"
                >
                  <div
                    *ngIf="
                      Formgroup.get('Consignee_Initial')?.errors?.['required']
                    "
                  >
                    Consignee Initial is required.
                  </div>
                  <div
                    *ngIf="
                      Formgroup.get('Consignee_Initial')?.errors?.['minlength']
                    "
                  >
                    Consignee Initial must be 3 characters.
                  </div>
                  <div
                    *ngIf="
                      Formgroup.get('Consignee_Initial')?.errors?.['maxlength']
                    "
                  >
                    Consignee Initial cannot exceed 3 characters.
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- PI No -->
        <div class="row mb-2">
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0">PI No</label>
              </div>
              <div class="col-7">
                <input
                  type="text"
                  class="form-control form-control-sm"
                  formControlName="PINo"
                  [style]="{
                    borderRadius: '5px',
                    height: '38px',
                    padding: '5px 10px',
                  }"
                />
              </div>
            </div>
          </div>
        </div>

        <!-- Date -->
        <div class="row mb-1">
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0">Date</label>
              </div>
              <div class="col-7">
                <input
                  type="text"
                  class="form-control form-control-sm"
                  formControlName="Date"
                  readonly
                  [style]="{
                    borderRadius: '5px',
                    height: '38px',
                    padding: '5px 10px',
                  }"
                />
              </div>
            </div>
          </div>
        </div>

        <hr />

        <!-- Row 1 -->
        <div class="row mb-2">
          <!-- Shippeer -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0">Shippeer</label>
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="ShipperList"
                  formControlName="Beneficiary_Account_ID"
                  optionLabel="CompanyName"
                  optionValue="Beneficiary_Account_ID"
                  [filter]="true"
                  filterBy="CompanyName"
                  [showClear]="true"
                  panelStyleClass="my-dropdown-panel"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Shippeer"
                ></p-dropdown>
              </div>
            </div>
          </div>

          <!-- Beneficiary's Bank -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0"
                  >Beneficiary's <br />
                  Bank</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="BenificaryBankList"
                  formControlName="Beneficiary_Bank_ID"
                  optionLabel="BankInfo"
                  optionValue="Beneficiary_Bank_ID"
                  [filter]="true"
                  filterBy="BankInfo"
                  [showClear]="true"
                  panelStyleClass="my-dropdown-panel"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Beneficiary's Bank"
                >
                </p-dropdown>
              </div>
            </div>
          </div>

          <!-- Country of Origin -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0"
                  >Country of <br />
                  Origin</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="CountryList"
                  formControlName="Country_Of_Orgin_ID"
                  optionLabel="Country"
                  optionValue="Country_ID"
                  [filter]="true"
                  filterBy="Country"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Country"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
        </div>

        <!-- Row 2 -->
        <div class="row mb-2">
          <!-- Packing -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0">Packing</label>
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="PackingList"
                  formControlName="Packing_ID"
                  optionLabel="Mode"
                  optionValue="Packing_ID"
                  [filter]="true"
                  filterBy="Mode"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Packing"
                >
                </p-dropdown>
              </div>
            </div>
          </div>

          <!-- Loading Mode -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0"
                  >Loading <br />
                  Mode</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="LoadingModeList"
                  formControlName="Loading_Mode_ID"
                  optionLabel="Details"
                  optionValue="Loading_Mode_ID"
                  [filter]="true"
                  filterBy="Details"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Loading Mode"
                >
                </p-dropdown>
              </div>
            </div>
          </div>

          <!-- Payment Mode -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0"
                  >Payment <br />
                  Mode</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="PaymentModeList"
                  formControlName="Payment_Term_ID"
                  optionLabel="Mode"
                  optionValue="Payment_Term_ID"
                  [filter]="true"
                  filterBy="Mode"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Payment Mode"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
        </div>

        <!-- Row 3 -->
        <div class="row mb-2">
          <!-- Consignee -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0">Consignee</label>
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="ConsigneeList"
                  formControlName="Customer_ID"
                  optionLabel="CustomerName"
                  optionValue="Customer_ID"
                  [filter]="true"
                  filterBy="CustomerName"
                  [showClear]="true"
                  panelStyleClass="my-dropdown-panel"
                  [virtualScroll]="true"
                  [itemSize]="30"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Consignee"
                >
                </p-dropdown>
              </div>
            </div>
          </div>

          <!-- Contact Person -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0"
                  >Contact <br />
                  Person</label
                >
              </div>
              <div class="col-7">
                <input
                  type="text"
                  class="form-control form-control-sm"
                  placeholder="Contact Person"
                  formControlName="Contact_Person"
                  style="
                    width: 100%;
                    height: 42px;
                    border-radius: 5px;
                    padding: 5px 10px;
                  "
                />
              </div>
            </div>
          </div>

          <!-- Applicant Bank -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0"
                  >Applicant <br />
                  Bank</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="ApplicantBankList"
                  formControlName="Customer_Bank_ID"
                  optionLabel="CustomerBankDetails"
                  optionValue="Applicant_Bank_ID"
                  [filter]="true"
                  filterBy="CustomerBankDetails"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Bank"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
        </div>

        <!-- Row 4 -->
        <div class="row mb-2">
          <!-- Buyer Name -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0">Buyer Name</label>
              </div>
              <div class="col-7">
                <input
                  type="text"
                  class="form-control form-control-sm"
                  placeholder="Buyer Name"
                  formControlName="Buyer_Name"
                  style="
                    width: 100%;
                    height: 42px;
                    border-radius: 5px;
                    padding: 5px 10px;
                  "
                />
              </div>
            </div>
          </div>

          <!-- Is Buying House Order -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0 mr-2"
                  >Is Buying <br />
                  House <br />
                  Order?</label
                >
              </div>
              <div class="col-7">
                <p-checkbox
                  inputId="IsBuyerMandatory"
                  name="IsBuyerMandatory"
                  [binary]="true"
                  formControlName="IsBuyerMandatory"
                  [style]="{ width: '100%' }"
                ></p-checkbox>
              </div>
            </div>
          </div>

          <!-- Buying House -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-0"
                  >Buying <br />
                  House</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="BuyingHouseList"
                  formControlName="Buyer_ID"
                  optionLabel="Buyer_Name"
                  optionValue="Id"
                  [filter]="true"
                  filterBy="Buyer_Name"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Buying House"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
        </div>

        <!-- Row 5 -->
        <div class="row mb-2">
          <!-- Delivery Address -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-1"
                  >Delivery <br />
                  Address</label
                >
              </div>

              <div class="col-7">
                <textarea
                  class="form-control form-control-sm"
                  rows="3"
                  formControlName="Delivery_Address"
                ></textarea>
              </div>
            </div>
          </div>

          <!-- Style -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-1">Style</label>
              </div>
              <div class="col-7">
                <textarea
                  class="form-control form-control-sm"
                  rows="3"
                  formControlName="Style"
                ></textarea>
              </div>
            </div>
          </div>

          <!-- Goods Description -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-1"
                  >Goods <br />
                  Description</label
                >
              </div>

              <div class="col-7">
                <textarea
                  class="form-control form-control-sm"
                  rows="3"
                  formControlName="Good_Description"
                ></textarea>
              </div>
            </div>
          </div>
        </div>

        <!-- Row 6 -->
        <div class="row mb-2">
          <!-- Expire Date -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-1">Expire Date</label>
              </div>

              <div class="col-7">
                <!-- <input
                  type="date"
                  formControlName="ExpireDate"
                  class="form-control"
                  style="height: 42px; border-radius: 5px; padding: 5px 10px"
                /> -->
                <p-calendar
                  formControlName="ExpireDate"
                  [showIcon]="false"
                  dateFormat="dd/mm/yy"
                  placeholder="Select Date"
                  class="w-100"
                  [style]="{ width: '100%' }"
                  inputStyleClass="form-control custom-date-input"
                ></p-calendar>
              </div>
            </div>
          </div>

          <!-- Terms of Delivery -->
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="mb-1"
                  >Terms <br />
                  of <br />
                  Delivery</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  [options]="TermsofDeliveryList"
                  formControlName="Terms_of_Delivery_ID"
                  optionLabel="Details"
                  optionValue="Id"
                  [filter]="true"
                  filterBy="Details"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  placeholder="Select Terms of Delivery"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
        </div>

        <!-- <div class="table-responsive">
          <table class="table table-sm table-bordered table-striped">
            <thead class="custom-header">
              <tr>
                <th class="text-center align-middle sticky-table-column">
                  <button
                    class="btn btn-xs theme-btn"
                    (click)="Addrow()"
                    type="button"
                  >
                    <i class="fas fa-plus"></i>
                  </button>
                </th>
                <th class="text-center align-middle">Article No</th>
                <th class="text-center align-middle">Description</th>
                <th class="text-center align-middle">Width</th>
                <th class="text-center align-middle">Color</th>
                <th class="text-center align-middle">Packaging</th>
                <th class="text-center align-middle">Qty</th>
                <th class="text-center align-middle">Unit</th>
                <th class="text-center align-middle">Unit Price ($)</th>
                <th class="text-center align-middle">Total Amount ($)</th>
                <th class="text-center align-middle">Prod. Cost Unit</th>
                <th class="text-center align-middle">Total Prod. Cost</th>
                <th class="text-center align-middle">A. A.</th>
              </tr>
            </thead>
            <tbody formArrayName="ItemArray">
              <ng-container *ngIf="Formgroup.controls.ItemArray != null">
                <tr
                  *ngFor="let itemrow of getControls(); let i = index"
                  [formGroupName]="i"
                >
                  <td class="sticky-table-column align-middle">
                    <button
                      class="btn btn-xs btn-danger"
                      (click)="DeleteRow(i)"
                      type="button"
                    >
                      <i class="fas fa-times"></i>
                    </button>
                  </td>
                  <td class="align-middle">
                    <input
                      style="width: 5rem; height: 48px"
                      formControlName="Article"
                      type="text"
                      class="form-control form-control-sm"
                      placeholder="Article No"
                      id="ArticleNo"
                      name="ArticleNo"
                    />
                  </td>
                
                  <td
                    class="align-middle"
                    style="position: relative; min-width: 200px"
                  >
                    <p-dropdown
                      formControlName="Description"
                      [options]="DescriptionList"
                      optionLabel="Details"
                      optionValue="Details"
                      [filter]="true"
                      filterBy="Details"
                      [showClear]="true"
                      appendTo="body"
                     panelStyleClass="description-panel"

                      [style]="{ width: '100%' }"
                      placeholder="Select a Description"
                      styleClass="table-dropdown"
                    >
                    </p-dropdown>
                  </td>
                  <td class="align-middle">
                    <p-dropdown
                      formControlName="Width_ID"
                      [options]="WidthList"
                      optionLabel="Measurement"
                      optionValue="Width_ID"
                      [filter]="true"
                      filterBy="Measurement"
                      [showClear]="true"
                      appendTo="body"
                       panelStyleClass="description-panel"
                      [style]="{ width: '100%' }"
                      placeholder="Select a Width"
                    >
                    </p-dropdown>
                  </td>
                  <td class="align-middle">
                    <p-dropdown
                      formControlName="Color_ID"
                      [options]="ColorList"
                      optionLabel="Color"
                      optionValue="Color_ID"
                      [filter]="true"
                      filterBy="Color"
                      [showClear]="true"
                      appendTo="body"
                       panelStyleClass="description-panel"
                      [style]="{ width: '100%' }"
                      placeholder="Select a Color"
                    >
                    </p-dropdown>
                  </td>
                  <td class="align-middle">
                    <p-dropdown
                      formControlName="Packaging_ID"
                      [options]="PackagingList"
                      optionLabel="Packaging"
                      optionValue="Packaging_ID"
                      [filter]="true"
                      filterBy="Packaging"
                      [showClear]="true"
                      appendTo="body"
                       panelStyleClass="description-panel"
                      [style]="{ width: '100%' }"
                      placeholder="Select a Packaging"
                    >
                    </p-dropdown>
                  </td>
                  <td class="align-middle">
                    <input
                      style="width: 7rem;height: 48px;"
                      (change)="calculateAmount(itemrow)"
                      formControlName="Quantity"
                      type="number"
                      class="form-control form-control-sm"
                      placeholder="Qty"
                      id="Qty"
                      name="Qty"
                    />
                  </td>
                  <td class="align-middle">
                    <p-dropdown
                      formControlName="Unit_ID"
                      [options]="UnitList"
                      optionLabel="Unit"
                      optionValue="Unit_ID"
                      [filter]="true"
                      filterBy="Unit"
                      [showClear]="true"
                      appendTo="body"
                       panelStyleClass="description-panel"
                      [style]="{ width: '100%' }"
                      placeholder="Select a Unit"
                    >
                    </p-dropdown>
                  </td>
                  <td class="align-middle">
                    <input
                      style="width: 5rem;height: 48px;"
                      (change)="calculateAmount(itemrow)"
                      formControlName="Unit_Price"
                      type="number"
                      class="form-control form-control-sm text-right"
                      placeholder="Unit Price"
                      id="Rate"
                      name="Rate"
                    />
                  </td>
                  <td class="align-middle">
                    <input
                      style="width: 5rem;height:48px"
                      formControlName="Total_Amount"
                      readonly="readOnly"
                      type="number"
                      class="form-control form-control-sm text-right"
                      placeholder="Total Amount"
                      id="Amount"
                      name="Amount"
                    />
                  </td>
                  <td class="align-middle">
                    <input
                      style="width: 5rem; height: 48px;"
                      (change)="calculateAmount(itemrow)"
                      formControlName="CommissionUnit"
                      type="text"
                      class="form-control form-control-sm text-right"
                      placeholder="Prod. Cost Unit"
                      id="ProdCost"
                      name="ProdCost"
                    />
                  </td>
                  <td class="align-middle">
                    <input
                      style="width: 5rem;height: 48px;"
                      formControlName="TotalCommission"
                      readonly="readOnly"
                      type="text"
                      class="form-control form-control-sm text-right"
                      placeholder="Total Prod. Cost"
                      id="TProdCost"
                      name="TProdCost"
                    />
                  </td>
                  <td class="align-middle">
                    <p-dropdown
                      formControlName="Item_ID"
                      [options]="AAList"
                      optionLabel="Article_No"
                      optionValue="Item_ID"
                      [filter]="true"
                      filterBy="Article_No"
                      [showClear]="true"
                      appendTo="body"
                       panelStyleClass="description-panel"
                      (onChange)="SetActualArticle(itemrow)"
                      [style]="{ width: '100%' }"
                      placeholder="Select a Article"
                    >
                    </p-dropdown>
                  </td>
                </tr>
              </ng-container>
            </tbody>
            <tfoot>
              <tr>
                <th class="sticky-table-column align-middle"></th>
                <th class="text-center align-middle">Total</th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle">
                  <input
                    type="text"
                    class="form-control form-control-sm"
                    value="{{ GTQTY }}"
                    placeholder="Total Qty"
                    id="GTQty"
                    name="GTQty"
                  />
                </th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle">
                  <input
                    type="text"
                    class="form-control form-control-sm text-right"
                    value="{{ GTAMNT }}"
                    placeholder="Total Amout"
                    id="GTAmout"
                    name="GTAmout"
                  />
                </th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle"></th>
                <th class="text-center align-middle"></th>
              </tr>
            </tfoot>
          </table>
        </div> -->

        <div class="table-responsive"
          style="
            max-height: 700px;
            overflow-y: auto;
            border: 1px solid #dee2e6;
            border-radius: 4px;
          "
        >
          <table
            class="table table-sm table-bordered table-striped"
            style="min-width: 3000px; margin-bottom: 0"
          >
            <thead
              class="custom-header"
              style="
                position: sticky;
                top: 0;
                background: white;
                z-index: 10;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
              "
            >
              <tr>
                <th
                  class="text-center align-middle sticky-table-column"
                  style="
                    width: 70px;
                    min-width: 70px;
                    max-width: 70px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  <button
                    class="btn btn-sm theme-btn"
                    (click)="Addrow()"
                    type="button"
                    style="padding: 4px 8px"
                  >
                    <i class="fas fa-plus"></i> Add
                  </button>
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 150px;
                    min-width: 150px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Article No
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 250px;
                    min-width: 250px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Description
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 120px;
                    min-width: 120px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Width
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 120px;
                    min-width: 120px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Color
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 130px;
                    min-width: 130px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Packaging
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 150px;
                    min-width: 150px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Qty
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 120px;
                    min-width: 120px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Unit
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 160px;
                    min-width: 160px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Unit Price ($)
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 160px;
                    min-width: 160px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Total Amount ($)
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 160px;
                    min-width: 160px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Prod. Cost Unit
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 160px;
                    min-width: 160px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  Total Prod. Cost
                </th>
                <th
                  class="text-center align-middle"
                  style="
                    width: 150px;
                    min-width: 150px;
                    background: #f8f9fa;
                    font-weight: 600;
                  "
                >
                  A. A.
                </th>
              </tr>
            </thead>
            <tbody formArrayName="ItemArray">
              <ng-container *ngIf="Formgroup.controls.ItemArray != null">
                <tr
                  *ngFor="let itemrow of getControls(); let i = index"
                  [formGroupName]="i"
                  style="border-bottom: 1px solid #dee2e6"
                >
                  <td
                    class="sticky-table-column align-middle text-center"
                    style="
                      width: 70px;
                      min-width: 70px;
                      max-width: 70px;
                      background: white;
                    "
                  >
                    <button
                      class="btn btn-sm btn-danger"
                      (click)="DeleteRow(i)"
                      type="button"
                      style="padding: 4px 8px"
                    >
                      <i class="fas fa-times"></i>
                    </button>
                  </td>

                  <td
                    class="align-middle"
                    style="width: 150px; min-width: 150px"
                  >
                    <input
                      style="
                        width: 100%;
                        height: 52px;
                        padding: 8px 12px;
                        font-size: 14px;
                      "
                      formControlName="Article"
                      type="text"
                      class="form-control form-control-sm"
                      placeholder="Enter Article No"
                      id="ArticleNo"
                      name="ArticleNo"
                    />
                  </td>

                  <td
                    class="align-middle"
                    style="width: 250px; min-width: 250px"
                  >
                    <p-dropdown
                      formControlName="Description"
                      [options]="DescriptionList"
                      optionLabel="Details"
                      optionValue="Details"
                      [filter]="true"
                      filterBy="Details"
                      [showClear]="true"
                      appendTo="body"
                      panelStyleClass="description-panel"
                      [style]="{ width: '100%', height: '52px' }"
                      placeholder="Select Description"
                      styleClass="table-dropdown w-100"
                    >
                    </p-dropdown>
                  </td>

                  <td
                    class="align-middle"
                    style="width: 120px; min-width: 120px"
                  >
                    <p-dropdown
                      formControlName="Width_ID"
                      [options]="WidthList"
                      optionLabel="Measurement"
                      optionValue="Width_ID"
                      [filter]="true"
                      filterBy="Measurement"
                      [showClear]="true"
                      appendTo="body"
                      panelStyleClass="description-panel"
                      [style]="{ width: '100%', height: '52px' }"
                      placeholder="Select Width"
                    >
                    </p-dropdown>
                  </td>

                  <td
                    class="align-middle"
                    style="width: 120px; min-width: 120px"
                  >
                    <p-dropdown
                      formControlName="Color_ID"
                      [options]="ColorList"
                      optionLabel="Color"
                      optionValue="Color_ID"
                      [filter]="true"
                      filterBy="Color"
                      [showClear]="true"
                      appendTo="body"
                      panelStyleClass="description-panel"
                      [style]="{ width: '100%', height: '52px' }"
                      placeholder="Select Color"
                    >
                    </p-dropdown>
                  </td>

                  <td
                    class="align-middle"
                    style="width: 130px; min-width: 130px"
                  >
                    <p-dropdown
                      formControlName="Packaging_ID"
                      [options]="PackagingList"
                      optionLabel="Packaging"
                      optionValue="Packaging_ID"
                      [filter]="true"
                      filterBy="Packaging"
                      [showClear]="true"
                      appendTo="body"
                      panelStyleClass="description-panel"
                      [style]="{ width: '100%', height: '52px' }"
                      placeholder="Select Packaging"
                    >
                    </p-dropdown>
                  </td>

                  <td
                    class="align-middle"
                    style="width: 150px; min-width: 150px"
                  >
                    <input
                      style="
                        width: 100%;
                        height: 52px;
                        padding: 8px 12px;
                        font-size: 14px;
                        text-align: right;
                        font-weight: 500;
                      "
                      (change)="calculateAmount(itemrow)"
                      formControlName="Quantity"
                      type="number"
                      class="form-control form-control-sm"
                      placeholder="Enter Quantity"
                      id="Qty"
                      name="Qty"
                    />
                  </td>

                  <td
                    class="align-middle"
                    style="width: 120px; min-width: 120px"
                  >
                    <p-dropdown
                      formControlName="Unit_ID"
                      [options]="UnitList"
                      optionLabel="Unit"
                      optionValue="Unit_ID"
                      [filter]="true"
                      filterBy="Unit"
                      [showClear]="true"
                      appendTo="body"
                      panelStyleClass="description-panel"
                      [style]="{ width: '100%', height: '52px' }"
                      placeholder="Select Unit"
                    >
                    </p-dropdown>
                  </td>

                  <td
                    class="align-middle"
                    style="width: 160px; min-width: 160px"
                  >
                    <input
                      style="
                        width: 100%;
                        height: 52px;
                        padding: 8px 12px;
                        font-size: 14px;
                        text-align: right;
                        font-weight: 500;
                      "
                      (change)="calculateAmount(itemrow)"
                      formControlName="Unit_Price"
                      type="number"
                      class="form-control form-control-sm"
                      placeholder="Enter Unit Price"
                      id="Rate"
                      name="Rate"
                    />
                  </td>

                  <td
                    class="align-middle"
                    style="width: 160px; min-width: 160px"
                  >
                    <input
                      style="
                        width: 100%;
                        height: 52px;
                        padding: 8px 12px;
                        font-size: 14px;
                        text-align: right;
                        font-weight: 600;
                        background-color: #f0f9ff;
                        border: 1px solid #b8daff;
                      "
                      formControlName="Total_Amount"
                      readonly="readOnly"
                      type="number"
                      class="form-control form-control-sm"
                      placeholder="Total Amount"
                      id="Amount"
                      name="Amount"
                    />
                  </td>

                  <td
                    class="align-middle"
                    style="width: 160px; min-width: 160px"
                  >
                    <input
                      style="
                        width: 100%;
                        height: 52px;
                        padding: 8px 12px;
                        font-size: 14px;
                        text-align: right;
                      "
                      (change)="calculateAmount(itemrow)"
                      formControlName="CommissionUnit"
                      type="text"
                      class="form-control form-control-sm"
                      placeholder="Enter Prod. Cost Unit"
                      id="ProdCost"
                      name="ProdCost"
                    />
                  </td>

                  <td
                    class="align-middle"
                    style="width: 160px; min-width: 160px"
                  >
                    <input
                      style="
                        width: 100%;
                        height: 52px;
                        padding: 8px 12px;
                        font-size: 14px;
                        text-align: right;
                        font-weight: 600;
                        background-color: #f0f9ff;
                        border: 1px solid #b8daff;
                      "
                      formControlName="TotalCommission"
                      readonly="readOnly"
                      type="text"
                      class="form-control form-control-sm"
                      placeholder="Total Prod. Cost"
                      id="TProdCost"
                      name="TProdCost"
                    />
                  </td>

                  <td
                    class="align-middle"
                    style="width: 150px; min-width: 150px"
                  >
                    <p-dropdown
                      formControlName="Item_ID"
                      [options]="AAList"
                      optionLabel="Article_No"
                      optionValue="Item_ID"
                      [filter]="true"
                      filterBy="Article_No"
                      [showClear]="true"
                      appendTo="body"
                      panelStyleClass="description-panel"
                      (onChange)="SetActualArticle(itemrow)"
                      [style]="{ width: '100%', height: '52px' }"
                      placeholder="Select Article"
                    >
                    </p-dropdown>
                  </td>
                </tr>
              </ng-container>
            </tbody>
            <tfoot
              style="
                position: sticky;
                bottom: 0;
                background: white;
                z-index: 10;
                box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.1);
              "
            >
              <tr style="background: #e9ecef; font-weight: 600">
                <th
                  class="sticky-table-column align-middle"
                  style="width: 70px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 150px; background: #e9ecef; font-size: 16px"
                >
                  Grand Total
                </th>
                <th
                  class="text-center align-middle"
                  style="width: 250px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 120px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 120px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 130px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 150px; background: #e9ecef"
                >
                  <input
                    type="text"
                    class="form-control form-control-sm text-right fw-bold"
                    value="{{ GTQTY }}"
                    placeholder="Total Qty"
                    id="GTQty"
                    name="GTQty"
                    readonly
                    style="
                      height: 48px;
                      font-size: 16px;
                      font-weight: 700;
                      background-color: #fff;
                      border: 2px solid #6c757d;
                    "
                  />
                </th>
                <th
                  class="text-center align-middle"
                  style="width: 120px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 160px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 160px; background: #e9ecef"
                >
                  <input
                    type="text"
                    class="form-control form-control-sm text-right fw-bold"
                    value="{{ GTAMNT }}"
                    placeholder="Total Amount"
                    id="GTAmout"
                    name="GTAmout"
                    readonly
                    style="
                      height: 48px;
                      font-size: 16px;
                      font-weight: 700;
                      background-color: #fff;
                      border: 2px solid #6c757d;
                    "
                  />
                </th>
                <th
                  class="text-center align-middle"
                  style="width: 160px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 160px; background: #e9ecef"
                ></th>
                <th
                  class="text-center align-middle"
                  style="width: 150px; background: #e9ecef"
                ></th>
              </tr>
            </tfoot>
          </table>
        </div>
        <hr />

        <div class="row">
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label"
                  >Delivery <br />
                  Condition</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  formControlName="Delivery_Condition_ID"
                  [options]="DeliveryConditionList"
                  optionLabel="Details"
                  optionValue="Delivery_Condition_ID"
                  [filter]="true"
                  filterBy="Details"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  panelStyleClass="my-dropdown-panel"
                  placeholder="Select a Delivery Condition"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label"
                  >Partial <br />
                  Shipment</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  formControlName="Shipment_Condition_ID"
                  [options]="PartialShipmentList"
                  optionLabel="ShipmentConditions"
                  optionValue="Shipment_Condition_ID"
                  [filter]="true"
                  filterBy="ShipmentConditions"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  panelStyleClass="my-dropdown-panel"
                  placeholder="Select a Shipment"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label"
                  >Price <br />
                  Terms</label
                >
              </div>
              <div class="col-7">
                <p-dropdown
                  formControlName="Price_Term_ID"
                  [options]="PriceTermsList"
                  optionLabel="PriceTerm"
                  optionValue="Price_Term_ID"
                  [filter]="true"
                  filterBy="PriceTerm"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  panelStyleClass="my-dropdown-panel"
                  placeholder="Select a Price Terms"
                >
                </p-dropdown>
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label">Documents</label>
              </div>
              <div class="col-7">
                <textarea
                  id="Documents"
                  class="form-control form-control-sm"
                  rows="3"
                  formControlName="Documents"
                ></textarea>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label"
                  >Port Of <br />
                  Loading</label
                >
              </div>

              <div class="col-7">
                <textarea
                  id="PortOfLoading"
                  class="form-control form-control-sm"
                  rows="3"
                  formControlName="Loading_Port"
                ></textarea>
              </div>
            </div>
          </div>

          <div class="col-md-4">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label"
                  >Port Of <br />
                  Destination</label
                >
              </div>
              <div class="col-7">
                <textarea
                  id="PortOfDestination"
                  class="form-control form-control-sm"
                  rows="3"
                  formControlName="Destination_Port"
                ></textarea>
              </div>
            </div>
          </div>

          <div class="col-md-4 mt-2">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label">Remarks</label>
              </div>
              <div class="col-7">
                <input
                  type="text"
                  class="form-control form-control-sm"
                  id="Remarks"
                  placeholder="Remarks"
                  formControlName="Remarks"
                  style="height: 42px"
                />
              </div>
            </div>
          </div>

          <div class="col-md-4 mt-2">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label"
                  >Force <br />
                  Majeure</label
                ><br />
              </div>
              <div class="col-7">
                <p-dropdown
                  formControlName="Force_Majeure_ID"
                  [options]="ForceMajeureList"
                  optionLabel="Force"
                  optionValue="Force_Majeure_ID"
                  [filter]="true"
                  filterBy="Force"
                  [showClear]="true"
                  [style]="{ width: '100%' }"
                  panelStyleClass="my-dropdown-panel"
                  placeholder="Select a Force Majeure"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
          <div class="col-md-4 mt-2">
            <div class="row g-1 align-items-start">
              <div class="col-3">
                <label class="control-label">Arbitration</label>
              </div>
              <div class="col-7">
                <p-dropdown
                  formControlName="Arbitration_ID"
                  [options]="ArbitrationList"
                  optionLabel="Detail"
                  optionValue="Arbitration_ID"
                  [filter]="true"
                  filterBy="Detail"
                  [showClear]="true"
                  panelStyleClass="my-dropdown-panel"
                  [style]="{ width: '100%' }"
                  placeholder="Select a Arbitration"
                >
                </p-dropdown>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
</div>
